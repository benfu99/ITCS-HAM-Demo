name: Pull Request Workflow
on: 
  pull_request

jobs: 
  Markdown-Linter:
    runs-on: ubuntu-latest
    steps:
    - name: Check out code
      uses: actions/checkout@v2
    - name: markdownlint-cli
      uses: avto-dev/markdown-lint@v1
      with:
        args: '.'
        config: '.markdownlint.yml'

  Deploy-Azure:
    needs: Markdown-Linter
    runs-on: ubuntu-latest
    steps:
    - name: Check out code
      uses: actions/checkout@v2
    - name: Build
      uses: jerryjvl/jekyll-build-action@v1
    - name: Login to Azure
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_BLOB_SECRET }}
    - name: Upload to blob storage
      uses: azure/CLI@v1
      with:
        inlineScript: |
          cd _site \
          az storage blob upload-batch --account-name itcshamdemo -d '$web' -s .
    - name: Logout from Azure
      run: |
            az logout
      if: always()